# RuntimeとEditor間のプロセス通信（IPC）

本エンジンでは、エディタとランタイムのプロセスを分離しています。  
２つのプロセスは、TCP/IPによる通信をすることで連携しています（プロセス間通信、IPC）。

## 導入の経緯

以前、私は[UnityでXbox向けにゲームを開発・リリースしました](../jinrikisha.md)。  
このとき、実機で動作確認をしていて、実装をすこし変えるたびに実行形式としてビルドしなおす必要がありました。  
私は、これがとても無駄であると感じていました。
  
そこで、ネットワーク通信によるプロセス間通信を自分のエンジンに実装しようと考えました。  
これにより、**どんなデバイスやプラットフォームで動くランタイムでさえも、PCのエディタからの編集を可能**にしようとしています。

## TCP/IPを使った理由

当初、TCP/IPではなくProtcolBuffersを用いることも検討していました。  
実際に動かして検証しみた結果、通信速度や自由度の高さなどからTCP/IPを採用しています。

## 通信プロトコルについて


現在は、Json形式のテキストデータを送受信していますが、今後バイナリ形式に移行する計画もあります。

## Runtimeでの描画結果をEditorに埋め込む仕組み

Editorの一部領域のWindowハンドルを、Runtimeに渡しています。  
Runtimeのレンダラは、そのWindowハンドルへ描画をすることで、ハメコミを実現しています。  

今後、他の機器で動作するRuntimeにも対応するために、ストリーミングによる描画への対応も予定しています。  

!!! note
    「Runtimeで作成したWindowを、EditorのWindowハンドルの子領域にする」といった実装への変更も検討中です。  
    この手段でもEditor側へ描画できることは確認済みですが、もう少し慎重に調査を続けてから決定します。  
